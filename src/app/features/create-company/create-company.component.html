<svg viewBox="0 0 134 139" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path
    d="M74 30C74 13.4315 87.4315 0 104 0H129C131.761 0 134 2.23858 134 5V83C134 113.928 108.928 139 78 139V139C75.7909 139 74 137.209 74 135V30Z"
    fill="var(--primary)" />
  <path
    d="M0 109C0 92.4315 13.4315 79 30 79V79C46.5685 79 60 92.4315 60 109V109C60 125.569 46.5685 139 30 139V139C13.4315 139 0 125.569 0 109V109Z"
    fill="var(--primary)" />
</svg>
<b-card [formGroup]="companyForm" [style.maxWidth.vw]="75">
  <b-card-content>
    @let u = authService.user();
    @if (u) {
      <div class="user-summary">
        <img class="avatar" [src]="u.avatar_url || 'https://placehold.co/92x92?text=User'" [alt]="u.name" />
        <div class="meta">
          <div class="name">{{ u.name }}</div>
          <div class="email">{{ u.email }}</div>
        </div>
      </div>
    }
    @if (success()) {
      <p class="success-msg">Company created! Redirecting…</p>
    }
    @if (errorMsg()) {
      <p class="error">{{ errorMsg() }}</p>
    }
    <!-- Name -->
    <label for="name">Name *</label>
    <input type="text" b-input id="name" formControlName="name" placeholder="Example HR" />
    @if (companyForm.get('name')?.invalid && companyForm.get('name')?.touched) {
      <div class="error">Name is required.</div>
    }
    <!-- Domain -->
    <label for="domain">Domain *</label>
    <input type="text" b-input id="domain" formControlName="domain" placeholder="company.com" />
    <small class="hint">Locked to your email domain.</small>
    @if (companyForm.get('domain')?.invalid && companyForm.get('domain')?.touched) {
      <div class="error">Domain is required.</div>
    }
    <!-- Subdomain -->
    <label for="subdomain">Subdomain *</label>
    <input type="text" b-input id="subdomain" formControlName="subdomain" placeholder="jobs" />
    @if (companyForm.get('subdomain')?.invalid && companyForm.get('subdomain')?.touched) {
      <div class="error">Subdomain is required.</div>
    }
    <!-- Company Logo -->
    <label for="logo">Logo</label>
    <input type="file" #logoInput hidden (change)="onFileChange($event, 'logo')" />
    @let logoFile = companyForm.get('logo')?.value;
    @if (!logoFile) {
      <button b-button type="button" variant="secondary" (click)="logoInput.click()">Update JPG/PNG (max 1MB)</button>
    }
    @if (logoFile) {
      <img [src]="logoPreviewUrl" alt="Logo preview" class="profile-preview-img" />
      <button b-button type="button" variant="secondary" (click)="removeFile('logo', logoInput)">Remove</button>
    }
    @if (fileErrors['logo']) {
      <div class="error">{{ fileErrors['logo'] }}</div>
    }
    <!-- Favicon -->
    <label for="favicon">Favicon</label>
    <input type="file" #faviconInput hidden (change)="onFileChange($event, 'favicon')" />
    @let favicon = companyForm.get('favicon')?.value;
    @if (!favicon) {
      <button b-button type="button" variant="secondary" (click)="faviconInput.click()">Update ICO (max 100KB)</button>
    }
    @if (favicon) {
      <img [src]="faviconPreviewUrl" alt="Favicon preview" class="favicon-preview-img" />
      <button b-button type="button" variant="secondary" (click)="removeFile('favicon', faviconInput)">Remove</button>
    }
    @if (fileErrors['favicon']) {
      <div class="error">{{ fileErrors['favicon'] }}</div>
    }
  </b-card-content>
  <!-- Final URL -->
  <b-card-content class="final-url">
    @let d = companyForm.get('domain')?.value;
    @let s = companyForm.get('subdomain')?.value;
    https://{{ (s || 'jobs') + '.' }}{{ d || 'company.com' }}
  </b-card-content>
  <b-card-footer [style.flexDirection]="'column'">
    <button b-button variant="primary" type="submit" (click)="onSubmit()" [disabled]="submitting() || success()">
      @if (submitting()) {
        Creating…
      } @else {
        Register your company
      }
    </button>
  </b-card-footer>
</b-card>
